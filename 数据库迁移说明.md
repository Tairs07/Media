# æ•°æ®åº“ä» SQL Server è¿ç§»åˆ° SQLite

## âœ… å·²å®Œæˆçš„æ›´æ”¹

### 1. åç«¯é…ç½®æ›´æ”¹

#### 1.1 NuGet åŒ…
- âŒ ç§»é™¤äº† `Microsoft.EntityFrameworkCore.SqlServer`
- âœ… æ·»åŠ äº† `Microsoft.EntityFrameworkCore.Sqlite`

#### 1.2 è¿æ¥å­—ç¬¦ä¸²
**appsettings.json**:
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=MediaShareDB.db"
  }
}
```

#### 1.3 Program.cs
```csharp
// ä»
options.UseSqlServer(builder.Configuration.GetConnectionString("DefaultConnection"));

// æ”¹ä¸º
options.UseSqlite(builder.Configuration.GetConnectionString("DefaultConnection"));
```

#### 1.4 ApplicationDbContext.cs
- æ›´æ–°äº†é»˜è®¤å€¼ SQLï¼š`GETUTCDATE()` â†’ `datetime('now', 'utc')`

### 2. è¿ç§»æ–‡ä»¶

- åˆ é™¤äº†æ—§çš„ SQL Server è¿ç§»æ–‡ä»¶
- åˆ›å»ºäº†æ–°çš„ SQLite è¿ç§»æ–‡ä»¶ï¼š`Migrations/20251031101941_InitialCreate.cs`

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### ç¬¬ä¸€æ¬¡è¿è¡Œ

1. **åº”ç”¨æ•°æ®åº“è¿ç§»**ï¼š
   ```bash
   cd backend
   dotnet ef database update
   ```

2. **å¯åŠ¨åç«¯æœåŠ¡**ï¼š
   ```bash
   dotnet run
   ```

æ•°æ®åº“æ–‡ä»¶ `MediaShareDB.db` å°†è‡ªåŠ¨åˆ›å»ºåœ¨ `backend` ç›®å½•ä¸‹ã€‚

### å¤‡ä»½æ•°æ®åº“

SQLite æ•°æ®åº“å¤‡ä»½éå¸¸ç®€å•ï¼Œåªéœ€å¤åˆ¶ `.db` æ–‡ä»¶ï¼š
```bash
cp backend/MediaShareDB.db backend/MediaShareDB.db.backup
```

### é‡ç½®æ•°æ®åº“

å¦‚æœéœ€è¦é‡ç½®æ•°æ®åº“ï¼ˆåˆ é™¤æ‰€æœ‰æ•°æ®ï¼‰ï¼š
```bash
cd backend
# åˆ é™¤æ•°æ®åº“æ–‡ä»¶
rm MediaShareDB.db  # Linux/Mac
del MediaShareDB.db  # Windows

# é‡æ–°åº”ç”¨è¿ç§»
dotnet ef database update
```

## ğŸ“Š SQLite vs SQL Server

| ç‰¹æ€§ | SQLite | SQL Server |
|------|--------|------------|
| **å®‰è£…è¦æ±‚** | æ— éœ€å®‰è£… | éœ€è¦å®‰è£…æ•°æ®åº“æœåŠ¡å™¨ |
| **é…ç½®æ–‡ä»¶** | å•ä¸ª .db æ–‡ä»¶ | å¤šä¸ªæ•°æ®æ–‡ä»¶å’Œæ—¥å¿— |
| **éƒ¨ç½²** | å¤åˆ¶æ–‡ä»¶å³å¯ | éœ€è¦é…ç½®æœåŠ¡å™¨ |
| **å¹¶å‘å†™å…¥** | æœ‰é™ï¼ˆå•å†™ï¼‰ | é«˜å¹¶å‘æ”¯æŒ |
| **é€‚ç”¨åœºæ™¯** | å¼€å‘/æµ‹è¯•/ä¸­å°å‹åº”ç”¨ | å¤§å‹ä¼ä¸šåº”ç”¨ |
| **æˆæœ¬** | å…è´¹ | éœ€è¦è®¸å¯è¯ |

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é»˜è®¤å€¼è¯­æ³•å·®å¼‚**ï¼š
   - SQL Server: `GETUTCDATE()`
   - SQLite: `datetime('now', 'utc')`

2. **æ•°æ®ç±»å‹**ï¼š
   - SQLite ä½¿ç”¨åŠ¨æ€ç±»å‹ï¼ŒEF Core ä¼šè‡ªåŠ¨æ˜ å°„

3. **å¹¶å‘é™åˆ¶**ï¼š
   - SQLite å†™å…¥æ—¶ä¼šé”å®šæ•´ä¸ªæ•°æ®åº“
   - é€‚åˆä¸­å°å‹åº”ç”¨ï¼Œä¸é€‚åˆé«˜å¹¶å‘åœºæ™¯

4. **ç”Ÿäº§ç¯å¢ƒ**ï¼š
   - å¦‚æœå°†æ¥éœ€è¦è¿ç§»åˆ° SQL Server æˆ– PostgreSQLï¼Œåªéœ€æ›´æ¢æ•°æ®åº“æä¾›ç¨‹åº

## ğŸ“ ç›¸å…³æ–‡æ¡£

- `backend/SQLiteè¯´æ˜.md` - SQLite è¯¦ç»†è¯´æ˜
- `backend/DatabaseDesign.md` - æ•°æ®åº“è®¾è®¡æ–‡æ¡£
- `backend/Migrations/` - æ•°æ®åº“è¿ç§»æ–‡ä»¶

## âœ… éªŒè¯

è¿è¡Œä»¥ä¸‹å‘½ä»¤ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼š

```bash
cd backend
dotnet build          # ç¼–è¯‘é¡¹ç›®
dotnet ef database update  # åº”ç”¨è¿ç§»
dotnet run            # å¯åŠ¨æœåŠ¡
```

å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œåº”è¯¥ä¼šçœ‹åˆ°ï¼š
- æ•°æ®åº“æ–‡ä»¶ `MediaShareDB.db` è¢«åˆ›å»º
- API æœåŠ¡æˆåŠŸå¯åŠ¨
- å¯ä»¥é€šè¿‡ Swagger UI è®¿é—® APIï¼ˆhttp://localhost:5000/swaggerï¼‰




